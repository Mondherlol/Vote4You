{% extends '/profile/index.html.twig' %}

{% block title %}Modifier le profil{% endblock %}

{% block body %}
    {% block spinner %}
        {{ parent() }}
    {% endblock %}

    {% block sidebar %}
        {{ parent() }}
    {% endblock %}

    {% block content %}
        <div class="content">
            {% block navbar %}
                {{ parent() }}
            {% endblock %}

            <div class="container mt-5">
                <h1 class="text-center mb-4">Modifier le Profil</h1>
                <div class="card shadow-sm p-4">
                    <div class="row">
                        <!-- Prévisualisation de l'image -->
                        <div class="col-md-4 text-center">
                            {% if user.profilePic %}
                                <img src="{{ asset(user.profilePic) }}" alt="Photo de profil" class="rounded-circle img-thumbnail mb-3" style="width: 150px; height: 150px; object-fit: cover;">
                            {% else %}
                                <img src="{{ asset('uploads/images/default-image.jpg') }}" alt="Photo de profil par défaut" class="rounded-circle img-thumbnail mb-3" style="width: 150px; height: 150px; object-fit: cover;">
                            {% endif %}
                            <p class="text-muted">Photo de profil actuelle</p>
                        </div>
                        <!-- Formulaire -->
                        <div class="col-md-8">
                            {{ form_start(form) }}
                            <div class="form-group mb-3">
                                {{ form_label(form.username, 'Nom d\'utilisateur', {'label_attr': {'class': 'form-label'}}) }}
                                {{ form_widget(form.username, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.username) }}
                            </div>
                            <div class="form-group mb-3">
                                {{ form_label(form.email, 'Adresse Email', {'label_attr': {'class': 'form-label'}}) }}
                                {{ form_widget(form.email, {'attr': {'class': 'form-control'}}) }}
                                {{ form_errors(form.email) }}
                            </div>
                            <div class="form-group mb-3">
                                {{ form_label(form.profilePic, 'Changer la photo de profil', {'label_attr': {'class': 'form-label'}}) }}
                                {{ form_widget(form.profilePic, {'attr': {'class': 'form-control', 'type': 'file'}}) }}
                                {{ form_errors(form.profilePic) }}
                                <small class="text-muted">Téléchargez une nouvelle photo (formats acceptés : JPG, PNG).</small>
                            </div>
                            <div class="form-group mb-3">
                                {{ form_label(form.plainPassword, 'Nouveau mot de passe', {'label_attr': {'class': 'form-label'}}) }}
                                {{ form_widget(form.plainPassword, {'attr': {'class': 'form-control', 'type': 'password'}}) }}
                                {{ form_errors(form.plainPassword) }}
                                <small class="text-muted">Laissez vide si vous ne souhaitez pas changer le mot de passe.</small>
                            </div>
                            <div class="form-group text-center mt-4">
                                <button type="submit" class="btn btn-primary px-5">Mettre à jour</button>
                                <a href="{{ path('app_profile_index', {'id': user.id}) }}" class="btn btn-secondary px-5">Annuler</a>
                            </div>
                            {{ form_end(form) }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% endblock %}
{% endblock %}
